# REDISH SFA 要件定義書

> **形式**: REDISH UIベースSDD開発手法 テンプレート準拠
> **作成日**: 2026-01-05（後付け適用）
> **原本**: `SFA_Webアプリ化_企画書・要件定義書.md`

---

## 1. 機能概要

### 1.1 機能の目的

REDISH SFAは、営業チームの業務効率化を目的としたWebアプリケーションです。
リードから成約までの営業プロセスを一元管理し、データに基づいた営業活動を支援します。

### 1.2 ユーザーストーリー

| ID | ユーザーストーリー |
|----|-------------------|
| US-01 | **営業担当として**、リード一覧を確認したい。**なぜなら**、優先度の高いリードに素早くアプローチできるから。 |
| US-02 | **営業担当として**、架電結果を記録したい。**なぜなら**、次回の架電時に過去の状況を把握できるから。 |
| US-03 | **営業担当として**、商談の確度を管理したい。**なぜなら**、成約見込みを予測できるから。 |
| US-04 | **営業担当として**、成約案件を管理したい。**なぜなら**、契約処理の漏れを防げるから。 |
| US-05 | **マネージャーとして**、架電結果を分析したい。**なぜなら**、チームの架電効率を改善できるから。 |
| US-06 | **マネージャーとして**、商談結果を分析したい。**なぜなら**、成約率向上の施策を立案できるから。 |

---

## 2. 機能要件

### 2.1 画面一覧

| 画面ID | 画面名 | 概要 | 実装状態 |
|--------|--------|------|:--------:|
| SCR-001 | ログイン画面 | Google OAuth認証 | ✅ |
| SCR-002 | ダッシュボード | KPI表示、クイックアクション | ✅ |
| SCR-003 | リード一覧 | リード検索・フィルタ・操作 | ✅ |
| SCR-004 | 架電管理 | 架電リスト、ステータス更新、履歴 | ✅ |
| SCR-005 | 商談管理 | 商談一覧・詳細・確度管理 | ✅ |
| SCR-006 | 成約管理 | 成約一覧・詳細 | ✅ |
| SCR-007 | 架電分析 | 架電結果の集計・グラフ | ✅ |
| SCR-008 | 商談分析 | 商談結果の集計・グラフ | ✅ |
| SCR-009 | 設定画面 | ユーザー設定 | ✅ |

### 2.2 機能一覧

| 機能ID | 機能名 | 概要 | 優先度 | 実装状態 |
|--------|--------|------|:------:|:--------:|
| LEAD-001 | リード一覧表示 | リードをテーブル形式で表示 | 高 | ✅ |
| LEAD-002 | リード詳細表示 | 個別リード情報をサイドパネルで表示 | 高 | ✅ |
| LEAD-003 | リード検索・フィルタ | 条件指定で絞り込み | 中 | ✅ |
| CALL-001 | 架電一覧表示 | 架電リストをテーブル形式で表示 | 高 | ✅ |
| CALL-002 | 架電詳細表示 | 個別架電情報をサイドパネルで表示 | 高 | ✅ |
| CALL-003 | 架電履歴登録 | 架電結果の記録 | 高 | ✅ |
| CALL-004 | 架電履歴一覧 | 過去の架電履歴をモーダルで表示 | 中 | ✅ |
| DEAL-001 | 商談一覧表示 | 商談をテーブル形式で表示 | 高 | ✅ |
| DEAL-002 | 商談詳細表示 | 個別商談情報をサイドパネルで表示 | 高 | ✅ |
| DEAL-003 | 商談ステータス更新 | 確度・結果の更新 | 高 | ✅ |
| CONT-001 | 成約一覧表示 | 成約をテーブル形式で表示 | 高 | ✅ |
| CONT-002 | 成約詳細表示 | 個別成約情報をサイドパネルで表示 | 高 | ✅ |
| ANAL-001 | 架電分析表示 | 架電結果の集計グラフ | 中 | ✅ |
| ANAL-002 | 商談分析表示 | 商談結果の集計グラフ | 中 | ✅ |

### 2.3 詳細要件（EARS形式準備）

#### LEAD-001: リード一覧表示

**トリガー条件**:
- WHEN ユーザーが「リード管理」メニューをクリックした時

**処理内容**:
- THEN システムは Supabaseからリードデータを取得する
- THEN システムは リードをテーブル形式で表示する

**条件分岐**:
- IF データが0件 THEN 「データがありません」メッセージを表示
- IF 検索条件あり THEN 条件に一致するリードのみ表示

**例外処理**:
- IF データ取得失敗 THEN 「データの取得に失敗しました」エラーを表示

---

#### CALL-003: 架電履歴登録

**トリガー条件**:
- WHEN ユーザーが架電詳細パネルで「履歴登録」ボタンをクリックした時

**処理内容**:
- THEN システムは 架電履歴モーダルを表示する
- THEN ユーザーが入力した架電結果をSupabaseに保存する
- THEN システムは 架電一覧を更新する

**条件分岐**:
- IF 必須項目未入力 THEN 「必須項目を入力してください」メッセージを表示

**例外処理**:
- IF 保存失敗 THEN 「保存に失敗しました」エラーを表示

---

#### DEAL-003: 商談ステータス更新

**トリガー条件**:
- WHEN ユーザーが商談詳細パネルで確度/結果を変更した時

**処理内容**:
- THEN システムは 変更内容をSupabaseに保存する
- THEN システムは 商談一覧を更新する

**条件分岐**:
- IF 結果が「成約」 THEN 成約管理にデータを連携
- IF 結果が「失注」 THEN 失注理由の入力を促す

**例外処理**:
- IF 保存失敗 THEN 「更新に失敗しました」エラーを表示

---

## 3. 非機能要件

### 3.1 パフォーマンス

| 項目 | 要件 | 実績 |
|------|------|------|
| 画面表示速度 | 初期表示3秒以内 | ✅ 達成 |
| データ更新 | 1秒以内 | ✅ 達成 |
| 同時接続数 | 10ユーザー程度 | ✅ 対応 |
| API応答時間 | 平均500ms以内 | ✅ 達成 |

### 3.2 セキュリティ

| 項目 | 要件 | 実装状態 |
|------|------|:--------:|
| 認証 | Google OAuth 2.0 | ✅ |
| 認可 | RLS（Row Level Security） | ✅ |
| API保護 | 認証ガード | ✅ |
| anon禁止 | anonポリシー削除 | ✅ |
| 通信 | HTTPS必須 | ✅ |

### 3.3 可用性

| 項目 | 要件 |
|------|------|
| 稼働時間 | 営業時間（平日9:00-18:00）99%以上 |
| バックアップ | Supabase自動バックアップ |
| 障害復旧 | 4時間以内 |

---

## 4. 画面設計（ワイヤーフレーム）

### 4.1 共通レイアウト

```
+------------------+----------------------------------------+
|                  |                                        |
|    Sidebar       |           Main Content                 |
|                  |                                        |
|  - ダッシュボード |  +------------------------------------+ |
|  - リード管理    |  |  Header (タイトル、検索、フィルタ)  | |
|  - 架電管理      |  +------------------------------------+ |
|  - 商談管理      |  |                                    | |
|  - 成約管理      |  |  Data Table                        | |
|  - 分析          |  |  (一覧表示)                        | |
|    - 架電分析    |  |                                    | |
|    - 商談分析    |  +------------------------------------+ |
|  - 設定          |                                        |
|                  +----------------------------------------+
|  ユーザー情報    |  Detail Panel (サイドパネル)           |
|  ログアウト      |  (詳細表示・編集)                      |
+------------------+----------------------------------------+
```

### 4.2 データテーブル構成

| テーブル | 主要カラム |
|----------|-----------|
| リード一覧 | リードID, 会社名, 担当者, ステータス, 作成日 |
| 架電一覧 | リードID, 会社名, 担当者, 架電ステータス, 最終架電日 |
| 商談一覧 | 商談ID, 会社名, 担当者, 確度, ステータス, 商談日 |
| 成約一覧 | 成約ID, 会社名, 担当者, 成約日, 金額 |

---

## 5. データ設計（概要）

### 5.1 主要エンティティ

| エンティティ | 説明 | 主要属性 |
|-------------|------|----------|
| leads | リード情報 | id, company_name, contact_name, status, source |
| calls | 架電リード情報 | id, lead_id, call_status, assigned_to |
| call_history | 架電履歴 | id, call_id, result, notes, called_at |
| deals | 商談情報 | id, lead_id, deal_status, probability, deal_date |
| contracts | 成約情報 | id, deal_id, contract_date, amount |

### 5.2 データフロー

```
leads (リード登録)
   ↓ ステータス変更
calls (架電管理)
   ↓ アポ獲得
deals (商談管理)
   ↓ 成約
contracts (成約管理)
```

---

## 6. 未決定事項（TBD）

| # | 項目 | 検討内容 | 期限 | 状態 |
|---|------|----------|------|:----:|
| 1 | PDF契約書生成 | 実装方法の検討 | 未定 | 🔄 |
| 2 | 外部システム連携 | Slack/カレンダー連携 | 未定 | 🔄 |
| 3 | AIによる確度予測 | 機械学習モデルの検討 | 未定 | 🔄 |

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2026-01-05 | UIベースSDD開発手法テンプレート形式で後付け作成 |
